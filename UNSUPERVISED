# -*- coding: utf-8 -*-
"""CUSTOMER SATISFACTION_US.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1T4bNrHR1-RmuJSASWgYbwET9xpmvi0u1
"""

from google.colab import drive
drive.mount("/content/drive/")

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

path="/content/drive/MyDrive/Colab Notebooks/ddd.csv"
data=pd.read_csv(path)
data.describe

data.head()

import pandas as pd
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from google.colab import files

# Create the Customer-Offer matrix
customer_offer_matrix = data.pivot_table(index='Customer Last Name', columns='Offer #', aggfunc='size', fill_value=0)

# Apply K-means clustering
kmeans = KMeans(n_clusters=5, random_state=0)
customer_clusters = kmeans.fit_predict(customer_offer_matrix)

# Add cluster labels to the DataFrame
customer_offer_matrix['Cluster'] = customer_clusters

# Count the number of people in each cluster
cluster_counts = customer_offer_matrix['Cluster'].value_counts()

# Print the counts
print(cluster_counts)

# Plot the clusters
plt.figure(figsize=(10, 8))
plt.scatter(customer_offer_matrix.iloc[:, 0], customer_offer_matrix.iloc[:, 1], c=customer_clusters, s=50, cmap='viridis')
plt.title('Customer Clustering')
plt.xlabel('Offer 1')
plt.ylabel('Offer 2')
plt.savefig('customer_clustering_plot.png')
plt.show()
